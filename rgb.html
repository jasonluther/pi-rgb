<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Raspberry Pi RGB LED</title>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
  <style>
body {
  background: rgb(128, 0, 255);
}
  </style>
</head>
<body>
<h1>Hello, world!</h1>
<h2 id="hex">HEXHEX</h2>
<h2 id="command">COMMAND</h2>
<ul id="commands">
<li><a href="#" class="cmd_button" id="cmd_off">Off</a></li>
<li><a href="#" class="cmd_button" id="cmd_on">On</a></li>
<li><a href="#" class="cmd_button" id="cmd_blink">Blink</a></li>
<li><a href="#" class="cmd_button" id="cmd_random">Random</a></li>
<li><a href="#" class="cmd_button" id="cmd_rainbow">Rainbow</a></li>
</ul>
<ul id="colors">
</ul>

<script>
var state = {hex:'ffffff',command:'on'};
function update(data) {
    state.hex = data.hex;
    state.command = data.command;
    $('body').css('background','#' + state.hex);
    $('#hex').html('#' + state.hex);
    $('#command').html(state.command);
    $('.cmd_button').parent().show();
    $('#cmd_' + state.command).parent().hide();
}
function rgbcmd(event) {
console.log(event.data);
  if (event.data.command) {
    state.command = event.data.command;
  }
  if (event.data.hex) {
    state.hex = event.data.hex;
  }
  $.getJSON("/rgbcmd/"+state.command+"/"+state.hex, update);
}

$(document).ready(function() {
  $.getJSON("/rgbcmd", update); 
  $("#cmd_on").click({command:'on'}, rgbcmd);
  $("#cmd_off").click({command:'off'}, rgbcmd);
  $("#cmd_blink").click({command:'blink'}, rgbcmd);
  $("#cmd_random").click({command:'random'}, rgbcmd);
  $("#cmd_rainbow").click({command:'rainbow'}, rgbcmd);
  var colors = [ 'ff0000', '00ff00', '0000ff', 'ffff00', 'ffffff' ];
  $.each(colors, function(index, val) {
    var li = '<li><a href="#" class="color_button" id="color_' + val + '">' + val + '</a></li>';
    $("#colors").append(li);
    $("#color_" + val).click({hex:val}, rgbcmd);
  });
});
</script>
</body>
</html>